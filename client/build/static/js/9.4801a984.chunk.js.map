{"version":3,"sources":["components/PageFormat.tsx"],"names":["dropdownStyles","dropdown","width","options","key","text","optKieuin","PageFormat","props","_formatPage","a","wsObject","ws","getValues","setPrintAreabySelected","setPaperType","state","pageSize","setOrientation","orientation","setPageZoom","autoInit","autoSetPrintArea","setPageMargin","isSetFont","setFont","blackAndWhite","setBlackAndWhite","_changePageSize","option","_index","setState","toString","_changOrientation","className","placeholder","label","defaultSelectedKey","this","styles","onChanged","defaultChecked","onText","offText","onChange","_e","checked","horizontal","onClick","allowDisabledFocus","Component"],"mappings":"sRA0BMA,EAA2C,CAChDC,SAAU,CAAEC,MAAO,MAGdC,EAA6B,CAClC,CAAEC,IAAK,KAAMC,KAAM,MACnB,CAAED,IAAK,KAAMC,KAAM,OAEdC,EAA+B,CACpC,CAAEF,IAAK,WAAYC,KAAM,YACzB,CAAED,IAAK,YAAaC,KAAM,UAEdE,EAAb,kDACC,WAAYC,GAAa,IAAD,8BACvB,cAAMA,IASPC,YAVwB,sBAUV,4BAAAC,EAAA,sEACI,IAAIC,IADR,QACPC,EADO,QAEVC,UAAU,SACbD,EAAGE,yBACHF,EAAGG,aAAa,EAAKC,MAAMC,UAC3BL,EAAGM,eAAe,EAAKF,MAAMG,aAC7BP,EAAGQ,YAAY,GACf,EAAKJ,MAAMK,SAAUT,EAAGU,mBAAqBV,EAAGE,yBACrB,aAA3B,EAAKE,MAAMG,YAA6BP,EAAGW,cAAc,GAAI,GAAI,GAAI,IAAMX,EAAGW,cAAc,GAAI,GAAI,GAAI,IACpG,EAAKP,MAAMQ,WAAWZ,EAAGa,QAAQ,mBACjC,EAAKT,MAAMU,eAAed,EAAGe,mBAVpB,4CAVU,EAsBxBC,gBAAkB,SAACC,EAAyBC,GAC3C,EAAKC,SAAS,CAAEd,SAAUY,EAAOzB,IAAI4B,cAvBd,EAyBxBC,kBAAoB,SAACJ,EAAyBC,GAC7C,EAAKC,SAAS,CAAEZ,YAAaU,EAAOzB,IAAI4B,cAxBxC,EAAKhB,MAAQ,CACZC,SAAU,KACVE,YAAa,WACbE,UAAU,EACVK,eAAe,EACfF,WAAW,GAPW,EADzB,qDA6BW,IAAD,OACR,OACC,6BAASU,UAAU,WAClB,kBAAC,IAAD,sEACA,yBAAKA,UAAU,eACd,yBAAKA,UAAU,+BACd,kBAAC,IAAD,CAAUC,YAAY,8BAAeC,MAAM,oBAAUC,mBAAoBC,KAAKtB,MAAMC,SAAUd,QAASA,EAASoC,OAAQvC,EAAgBwC,UAAWF,KAAKV,kBACxJ,kBAAC,IAAD,CAAUO,YAAY,yBAAeC,MAAM,eAAUC,mBAAoBC,KAAKtB,MAAMG,YAAahB,QAASG,EAAWiC,OAAQvC,EAAgBwC,UAAWF,KAAKL,oBAC7J,kBAAC,IAAD,CACCC,UAAU,OACVO,eAAgBH,KAAKtB,MAAMK,SAC3BqB,OAAO,wDACPC,QAAQ,wDACRC,SAAU,SAACC,EAAIC,GAAL,OAAiB,EAAKf,SAAS,CAACV,SAAUyB,IAAW,OAChE,kBAAC,IAAD,CACCZ,UAAU,OACVO,eAAgBH,KAAKtB,MAAMU,cAC3BgB,OAAO,yBACPC,QAAQ,yBACRC,SAAU,SAACC,EAAIC,GAAL,OAAiB,EAAKf,SAAS,CAACL,cAAeoB,IAAW,OACrE,kBAAC,IAAD,CACCZ,UAAU,OACVO,eAAgBH,KAAKtB,MAAMQ,UAC3BkB,OAAO,sCACPC,QAAQ,sCACRC,SAAU,SAACC,EAAIC,GAAL,OAAiB,EAAKf,SAAS,CAACP,UAAWsB,SAGxD,yBAAKZ,UAAU,eACd,yBAAKA,UAAU,4BACd,kBAAC,IAAD,CAAOa,YAAU,GAChB,kBAAC,IAAD,CAAe1C,KAAK,2BAAY2C,QAASV,KAAK7B,YAAawC,oBAAkB,YA5DpF,GAAgCC,aAoEjB3C","file":"static/js/9.4801a984.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Dropdown, IDropdownOption, IDropdownStyles } from 'office-ui-fabric-react/lib/Dropdown';\r\nimport { PrimaryButton } from 'office-ui-fabric-react';\r\nimport { Separator } from 'office-ui-fabric-react/lib/Separator';\r\nimport { Stack } from 'office-ui-fabric-react/lib/Stack';\r\nimport { Toggle } from 'office-ui-fabric-react/lib/Toggle';\r\nimport { wsObject } from \"../api/Eutils\";\r\n// import { getPageType, getOrientationType } from \"../api/mapIndex\"\r\n\r\nexport interface AppProps {\r\n}\r\nexport interface AppStates {\r\n\tpageSize: string;\r\n\torientation: string;\r\n\tautoInit: boolean;\r\n\tblackAndWhite: boolean;\r\n\tisSetFont: boolean | undefined;\r\n}\r\n\r\nexport interface orientationOptions {\r\n\tkey: string,\r\n\ttext: string,\r\n\tvalue: Excel.PageOrientation\r\n}\r\n\r\n\r\nconst dropdownStyles: Partial<IDropdownStyles> = {\r\n\tdropdown: { width: 300 }\r\n};\r\n\r\nconst options: IDropdownOption[] = [\r\n\t{ key: \"a4\", text: \"A4\" },\r\n\t{ key: \"a3\", text: \"A3\" },\r\n];\r\nconst optKieuin: IDropdownOption[] = [\r\n\t{ key: \"portrait\", text: \"Dọc\" },\r\n\t{ key: \"landscape\", text: \"Ngang\" },\r\n];\r\nexport class PageFormat extends Component<AppProps, AppStates> {\r\n\tconstructor(props: any) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tpageSize: 'a4',\r\n\t\t\torientation: 'portrait',\r\n\t\t\tautoInit: false,\r\n\t\t\tblackAndWhite: true,\r\n\t\t\tisSetFont: false\r\n\t\t}\r\n\t}\r\n\t_formatPage = async () => {\r\n\t\tconst ws = await new wsObject();\r\n\t\tws.getValues('A1:A2');\r\n\t\tws.setPrintAreabySelected();\r\n\t\tws.setPaperType(this.state.pageSize);\r\n\t\tws.setOrientation(this.state.orientation);\r\n\t\tws.setPageZoom(1)\r\n\t\tthis.state.autoInit? ws.autoSetPrintArea() : ws.setPrintAreabySelected()\r\n\t\tthis.state.orientation === \"portrait\" ? ws.setPageMargin(40, 40, 50, 40) : ws.setPageMargin(50, 40, 40, 40)\r\n\t\tif (this.state.isSetFont) ws.setFont('Times New Roman');\r\n\t\tif (this.state.blackAndWhite) ws.setBlackAndWhite();\r\n\t}\r\n\t_changePageSize = (option: IDropdownOption, _index?: number) => {\r\n\t\tthis.setState({ pageSize: option.key.toString() });\r\n\t}\r\n\t_changOrientation = (option: IDropdownOption, _index?: number) => {\r\n\t\tthis.setState({ orientation: option.key.toString() });\r\n\t}\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<section className=\"ms-Grid\">\r\n\t\t\t\t<Separator>Định dạng trạng in tự động</Separator>\r\n\t\t\t\t<div className=\"ms-Grid-row\">\r\n\t\t\t\t\t<div className=\"ms-Grid-col ms-sm12 ms-lg12\">\r\n\t\t\t\t\t\t<Dropdown placeholder=\"Chọn cỡ giấy\" label=\"Cỡ giấy\" defaultSelectedKey={this.state.pageSize} options={options} styles={dropdownStyles} onChanged={this._changePageSize} />\r\n\t\t\t\t\t\t<Dropdown placeholder=\"Chọn kiểu in\" label=\"Kiểu in\" defaultSelectedKey={this.state.orientation} options={optKieuin} styles={dropdownStyles} onChanged={this._changOrientation} />\r\n\t\t\t\t\t\t<Toggle \r\n\t\t\t\t\t\t\tclassName=\"mt-8\" \r\n\t\t\t\t\t\t\tdefaultChecked={this.state.autoInit} \r\n\t\t\t\t\t\t\tonText=\"Tự động nhận dạng vùng in\" \r\n\t\t\t\t\t\t\toffText=\"Tự động nhận dạng vùng in\" \r\n\t\t\t\t\t\t\tonChange={(_e, checked) => this.setState({autoInit: checked || false})} />\r\n\t\t\t\t\t\t<Toggle \r\n\t\t\t\t\t\t\tclassName=\"mt-8\" \r\n\t\t\t\t\t\t\tdefaultChecked={this.state.blackAndWhite} \r\n\t\t\t\t\t\t\tonText=\"In đen trắng\" \r\n\t\t\t\t\t\t\toffText=\"In đen trắng\" \r\n\t\t\t\t\t\t\tonChange={(_e, checked) => this.setState({blackAndWhite: checked || true})} />\r\n\t\t\t\t\t\t<Toggle \r\n\t\t\t\t\t\t\tclassName=\"mt-8\" \r\n\t\t\t\t\t\t\tdefaultChecked={this.state.isSetFont} \r\n\t\t\t\t\t\t\tonText=\"Đặt font Times New Romans\" \r\n\t\t\t\t\t\t\toffText=\"Đặt font Times New Romans\" \r\n\t\t\t\t\t\t\tonChange={(_e, checked) => this.setState({isSetFont: checked})} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"ms-Grid-row\">\r\n\t\t\t\t\t<div className=\"ms-Grid-col ms-sm12 mt-8\">\r\n\t\t\t\t\t\t<Stack horizontal>\r\n\t\t\t\t\t\t\t<PrimaryButton text=\"Định dạng\" onClick={this._formatPage} allowDisabledFocus />\r\n\t\t\t\t\t\t</Stack>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</section>\r\n\t\t);\r\n\t}\r\n};\r\nexport default PageFormat"],"sourceRoot":""}